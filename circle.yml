machine:
  python:
    version: 3.5.0

  environment:
    DJANGO_SECRET: $(openssl rand -base64 32)

dependencies:
  pre:
    - pip install -r requirements.txt
    - pip install -r requirements_test.txt

test:
  override:
    - make test

deployment:
    production:
      branch: master
      commands:
        - git push -f git@heroku.com:dlogr-api.git $CIRCLE_SHA1:master
        - heroku run python manage.py migrate --app dlogr-api
